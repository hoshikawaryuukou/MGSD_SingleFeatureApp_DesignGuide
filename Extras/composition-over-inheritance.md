# 組合優於繼承 (Composition over Inheritance)

## 是什麼

一個經典的物件導向設計原則，它提倡：**「Has-A」關係比「Is-A」關係更靈活。**

換句話說，我們應該優先考慮通過將功能拆分成獨立的、職責單一的組件來構建複雜的物件，而不是通過建立一個龐大且僵硬的繼承樹。

## 組合的真正力量：DI 賦予的靈活性

傳統上，「組合優於繼承」的論點常常圍繞**靈活性**和**避免繼承層級過深**展開。這些都很有道理，但在我們的架構中，這個原則之所以能發揮最大威力，是因為有**依賴注入 (DI) 的強力支持**。

### 1. 組合的成本被極大降低
在沒有 DI 的情況下，手動管理和組裝大量的-小組件本身就是一件繁瑣的工作，需要編寫大量的「膠水程式碼」。

然而，**藉助 DI 容器，我們可以像聲明配方一樣，輕鬆地將各種功能組件「注入」到主物件中。** 主物件只需要在其建構子中聲明它「需要」哪些能力（例如 `IInputHandler`, `IMovementStrategy`），DI 容器就會自動為它找到並組裝好正確的實例。**組裝的成本幾乎為零。**

### 2. 高度的可替換性與可測試性
繼承關係是靜態的，在編譯時就已鎖定。而基於 DI 的組合則是**極度動態**的。

這讓我們可以輕易地為一個物件替換不同的行為組件或依賴。例如，在測試時，我們可以注入一個 `MockDataService` 來替代真實的 `ApiService`，從而隔離測試目標，這種靈活性是繼承難以比擬的。

## 推薦的實踐

我們應該致力於將複雜的類別設計成輕量的「協調者」（Coordinator）。這些協調者類別本身不透過繼承龐大的基類來獲取功能，而是在其內部**組合**多個職責單一的服務或組件（通常透過 DI 注入），並**委託**它們去完成具體的工作。

採用這種模式，是打造**高內聚、低耦合**程式碼的關鍵策略，能有效提升程式碼的可維護性與彈性。